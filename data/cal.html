<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>MINISPECTRO</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script type="text/javascript"   src="jquery-3.3.1.min.js"></script>

        <link rel="stylesheet" href="w3.css">

        <link rel="stylesheet" href="style.css">
        <style>
            html,body,h1,h2,h3,h4,h5,h6 {font-family: sans-serif;}
            .w3-sidebar {
                z-index: 3;
                width: 250px;
                top: 43px;
                bottom: 0;
                height: inherit;
                
            }
            .blue {
  color: blue;
  
}.red {
  color: red;
  
}.green {
  color: green;
  
}
        </style>

        <script>

            $(document).ready(function () {
                
                $("#s1").change(function () {
                
                    $("#lightsource").css("color","red");
                    
                    var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    data = this.responseText;                                              
                   
                }
            };
            xhttp.open("GET", "/cal_redweb", true);
            xhttp.send();
                    
                });
                $("#s2").change(function () {
                    $("#lightsource").css("color","green");
                    var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    data = this.responseText;                                              
                   
                }
            };
            xhttp.open("GET", "/cal_greenweb", true);
            xhttp.send();
                
            });
            $("#s3").change(function () {
                $("#lightsource").css("color","blue");
                var xhttp = new XMLHttpRequest();
                xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    data = this.responseText;                                              
                   
                }
            };
            xhttp.open("GET", "/cal_blueweb", true);
            xhttp.send();
                
            });

            $("button#blank").click(function () {
                
                if(confirm("ยืนยันการตั้งค่าBlank"))
                {
            var data = "";               
            
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                data = this.responseText;                                              
               
            }
        };
        xhttp.open("GET", "/blank", true);
        xhttp.send();
                }
                
            });

            
            $("button#cal").click(function () {
                
               
            var data = "";               
            
            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                data = this.responseText;                                              
                document.getElementById("slop").innerHTML = data;
            }
        };
        xhttp.open("GET", "/calcaliweb", true);
        xhttp.send();
                
                
            });

            
            $("button#save").click(function () {
              
                var data = "";               
                var file_name = prompt("filename", makeid());

            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
                data = this.responseText;                                              
                document.getElementById("slop").innerHTML = data;
            }
        };
        xhttp.open("GET", "/savecali?id_nname="+file_name, true);
        xhttp.send();
                

            });


            });

            function makeid() {
  var text = "";
  var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";

  for (var i = 0; i < 5; i++)
    text += possible.charAt(Math.floor(Math.random() * possible.length));

  return text;
}
        </script>
    </head>
    <body>

        <!-- Top container -->
        <div class="w3-bar w3-top w3-blue-gray w3-large" style="z-index:4">
            <button class="w3-bar-item w3-button w3-hide-large w3-hover-none w3-hover-text-light-grey" onclick="w3_open();"> Menu</button>
            <span class="w3-bar-item w3-right">Linotech</span>
        </div>
        <!-- Sidebar/menu -->
        <nav class="w3-sidebar w3-collapse w3-white w3-animate-left" style="z-index:3;width:300px;" id="mySidebar"><br>
            <div class="w3-container w3-row">

                <div class="w3-col s8 w3-bar">
                    <h5> CALCULATION</h5><br>

                </div>
            </div>
            <hr>
            <div class="w3-container">
                <h5>MINISPECTRO</h5>
            </div>
            <div class="w3-bar-block">
                <a href="#" class="w3-bar-item w3-button w3-padding-16 w3-hide-large w3-dark-grey w3-hover-black" onclick="w3_close()" title="close menu"><i class="fa fa-remove fa-fw"></i>  Close Menu</a>
                <a href="index.html" class="w3-bar-item w3-button w3-padding ">  ABS</a>
                <a href="concen.html" class="w3-bar-item w3-button w3-padding">  CONCENTRATION</a>
                <a href="cal.html" class="w3-bar-item w3-button w3-padding  w3-blue"  >  CALCULATION</a>
                <a href="kinetic.html" class="w3-bar-item w3-button w3-padding">  KINETIC</a>
                <a href="source.html" class="w3-bar-item w3-button w3-padding">  Light SOURCE</a>
               <br><br>
            </div>
        </nav>

        <!-- Overlay effect when opening sidebar on small screens -->
        <div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>
        <div class="w3-main" style="margin-left:300px;margin-top:43px;">

            <!-- Header -->
            <header class="w3-container" style="padding-top:22px">
                <h5><b> CALCULATION</b></h5>
            </header>
            <div class="w3-row-padding w3-margin-bottom w3-padding-16 w3-center-align" >
                <div class=" w3-threequarter w3-padding-16 w3-center-align">
                    <div class="w3-container w3-round w3-border w3-padding-16 w3-border-blue  w3-padding-16 " id="lightsource">
                        <h2>Light source</h2>
                        &nbsp &nbsp  &nbsp &nbsp 
                        <input class="w3-radio " type="radio" name="gender" value="red" id="s1" >
                        <label>S1 &nbsp &nbsp </label>
                        &nbsp &nbsp  &nbsp &nbsp 
                        <input class="w3-radio" type="radio" name="gender" value="green" id="s2" >
                        <label> S2 &nbsp &nbsp </label>
                        &nbsp &nbsp  &nbsp &nbsp 
                        <input class="w3-radio" type="radio" name="gender" value="blue" id="s3" >
                        <label>S3</label>
                        <div class="w3-container w3-row-padding w3-round    w3-threequarter  ">
                                <div class="w3-quarter w3-padding-16 w3-center-align">
                              <p><h3 id="slop" >Y=mx+c</h3></p>
                                </div>
                
                            </div>
                        <div class="w3-container w3-row-padding  ">
                                <div class="w3-quarter w3-padding-16">
                                    <button id="blank" class="w3-button w3-xlarge w3-block w3-dark-grey w3-center-align">Blank</button>
                                </div>
                                <div class="w3-quarter w3-padding-16">
                                    <button id="cal" class="w3-button w3-xlarge w3-block w3-dark-grey w3-center-align">Cal</button>
                                </div>
                                <div class="w3-quarter w3-padding-16">
                                    <button id="save" class="w3-button w3-xlarge w3-block w3-dark-grey w3-center-align">Save</button>
                                </div>
                

                            </div>

                            
                            <table class="w3-table-all w3-card-4 ">
                                    <tr>
                                        <th>#</th>
                                        <th>Con</th>
                                        <th>Abs</th>
                                        <th>add</th>
                                    </tr>
                                    <tr>
                                        <td>1</td>
                                        <td id="con1">0</td>
                                        <td id="Abs1">0</td>
                                        <td><button onclick="setTable(1)" class="w3-button w3-medium w3-threequarter w3-dark-grey w3-center-align">เพิ่ม1</button></td>
                                    </tr>
                                    <tr>
                                        <td>2</td>
                                        <td id="con2">0</td>
                                        <td id="Abs2">0</td>
                                        <td><button onclick="setTable(2)" class="w3-button w3-medium w3-threequarter w3-dark-grey w3-center-align">เพิ่ม2</button></td>
                                    </tr>
                                    <tr>
                                        <td>3</td>
                                        <td id="con3">0</td>
                                        <td id="Abs3">0</td>
                                        <td><button onclick="setTable(3)" class="w3-button w3-medium  w3-threequarter w3-dark-grey w3-center-align">เพิ่ม3</button></td>
                                    </tr>
                                    <tr>
                                        <td>4</td>
                                        <td id="con4">0</td>
                                        <td id="Abs4">0</td>
                                        <td><button onclick="setTable(4)" class="w3-button w3-medium  w3-threequarter w3-dark-grey w3-center-align">เพิ่ม4</button></td>
                                    </tr>
                                    <tr>
                                        <td>5</td>
                                        <td id="con5">0</td>
                                        <td id="Abs5">0</td>
                                        <td><button onclick="setTable(5)" class="w3-button w3-medium  w3-threequarter w3-dark-grey w3-center-align">เพิ่ม5</button></td>
                                    </tr>
                
                                </table>
                    
                    </div>

                    
                </div>
               
                
            </div>
            
            
           
            



            <!-- Footer -->
            <footer class="w3-container w3-padding-16 ">

                <p>Powered by <a href="http://www.linotech.biz/" target="_blank">Linotech</a></p>
            </footer>

            <!-- End page content -->
        </div>

        <script>
            // Get the Sidebar
            var mySidebar = document.getElementById("mySidebar");

            // Get the DIV with overlay effect
            var overlayBg = document.getElementById("myOverlay");

            // Toggle between showing and hiding the sidebar, and add overlay effect
            function w3_open() {
                if (mySidebar.style.display === 'block') {
                    mySidebar.style.display = 'none';
                    overlayBg.style.display = "none";
                } else {
                    mySidebar.style.display = 'block';
                    overlayBg.style.display = "block";
                }
            }

            // Close the sidebar with the close button
            function w3_close() {
                mySidebar.style.display = "none";
                overlayBg.style.display = "none";
            }

            setInterval(function () {
                // Gets ADC value at every one second
                Gettable();
            }, 1000);

            function Gettable() {
                var xhttp = new XMLHttpRequest();
                var data = "";
                var data1 = "";
                
                xhttp.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {
                        data = this.responseText;
                        data1 = data.split(",");                                               
                        document.getElementById("con1").innerHTML = data1[0];
                        document.getElementById("con2").innerHTML = data1[1];
                        document.getElementById("con3").innerHTML = data1[2];
                        document.getElementById("con4").innerHTML = data1[3];
                        document.getElementById("con5").innerHTML = data1[4];

                        document.getElementById("Abs1").innerHTML = data1[5];
                        document.getElementById("Abs2").innerHTML = data1[6];
                        document.getElementById("Abs3").innerHTML = data1[7];
                        document.getElementById("Abs4").innerHTML = data1[8];
                        document.getElementById("Abs5").innerHTML = data1[9];
                      
                    }
                };
                xhttp.open("GET", "/gettablecal", true);
                xhttp.send();
            }
            function setTable(id_table) {
            var volumein = 0;
            if (id_table <= 8) {
                 volumein = prompt("ความเข้มข้น", "");

                if (isNaN(volumein)) {
                    alert("กรุณาระบุความเข้มข้นใหม่");
                    volumein = 0;
                }
            }

            var xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("LEDState").innerHTML =
                        this.responseText;
                }
            };
            xhttp.open("GET", "/setcaltable?id_num=" + id_table + "&Val=" + volumein, true);
            xhttp.send();
        }
        </script>
    </body>
</html>
